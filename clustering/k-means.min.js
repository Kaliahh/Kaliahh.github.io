async function setup(){for(createCanvas(windowWidth,windowHeight),background(51),numberOfPoints=Math.floor(width/3);;){distanceMoved=0,k=getRandomInt(3,6),listOfPoints=createPoints(numberOfPoints);let i=getClusterColors();for(listOfCentroids=pickInitialCentroids(listOfPoints,i);;){if(KMeans(listOfPoints,listOfCentroids),distanceMoved<.1){await sleep(500);break}await sleep(300),distanceMoved=0}}}function draw(){for(background(51),i=0;i<numberOfPoints;i++)listOfPoints[i].display();for(i=0;i<k;i++)listOfCentroids[i].display()}function KMeans(i,t){assignPointsToCentroids(i,t),updateCentroids(i,t)}function assignPointsToCentroids(t,n){for(i=0;i<t.length;i++)for(j=0;j<n.length;j++)null==t[i].centroid?(t[i].centroid=n[j],t[i].distanceToCentroid=distanceBetweenTwoPoints(t[i],t[i].centroid),t[i].color=t[i].centroid.color):t[i].centroid!=n[j]&&(t[i].distanceToCentroid=distanceBetweenTwoPoints(t[i],t[i].centroid),distanceToNewCentroid=distanceBetweenTwoPoints(t[i],n[j]),distanceToNewCentroid<=t[i].distanceToCentroid&&(t[i].centroid=n[j],t[i].distanceToCentroid=distanceToNewCentroid,t[i].color=t[i].centroid.color))}function updateCentroids(t,n){for(positionList=[],pointsPerCentroid=[],i=0;i<t.length;i++)for(j=0;j<n.length;j++)t[i].centroid==n[j]&&(null==positionList[j]?(positionList[j]=createVector(t[i].position.x,t[i].position.y),pointsPerCentroid[j]=1):(positionList[j].add(createVector(t[i].position.x,t[i].position.y)),pointsPerCentroid[j]+=1));for(j=0;j<n.length;j++)if(null!=positionList[j]){let i=positionList[j].x/pointsPerCentroid[j],t=positionList[j].y/pointsPerCentroid[j],o=createVector(i,t);distanceMoved+=o.dist(n[j].position),n[j].position=o}}function pickInitialCentroids(t,n){for(centroidList=[],i=0;i<k;i++)randomIndex=getRandomInt(0,numberOfPoints),newCentroid=new Point(t[randomIndex].position.x,t[randomIndex].position.y,20),newCentroid.color=n[i],centroidList.push(newCentroid);return centroidList}function placeCentroidsInCentre(i){for(centroidList=[],j=0;j<k;j++)newCentroid=new Point(width/2+j,height/2+j,20),newCentroid.color=i[j],centroidList.push(newCentroid);return centroidList}